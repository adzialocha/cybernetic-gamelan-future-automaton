webpackJsonp([0],{32:function(e,t,n){e.exports=n(33)},33:function(e,t,n){"use strict";var r=n(34);var i=d(r);var s=n(35);var o=d(s);var a=n(36);var u=d(a);var c=n(52);var f=d(c);var l=n(87);var h=d(l);var v=n(88);var p=d(v);function d(e){return e&&e.__esModule?e:{default:e}}var y=new o.default;var m=new u.default;var g=new h.default;var k=new p.default;var b=new f.default({onOpen:function e(){k.changeConnectionState(false,true);m.start()},onClose:function e(){k.changeConnectionState(false,false);m.stop()},onOpenRemote:function e(t){k.addRemotePeer(t)},onCloseRemote:function e(t){k.removeRemotePeer(t)},onSyncTick:function e(t){k.updateOffset(t);k.tick();m.instrument.syncTick()},onReceive:function e(t,n){y.receive(t,n)},onError:function e(t){k.addErrorMessage(t.message)}});y.setNetwork(b);window.addEventListener("load",function(){k.changeConnectionState(false,false);k.updateSettings(g.getConfiguration());k.changePattern(m.getCurrentPattern())});window.automaton=window.automaton||{network:{connect:function e(t){t.preventDefault();if(b.connect(g.getConfiguration())){k.changeConnectionState(true,false)}},disconnect:function e(t){t.preventDefault();k.changeConnectionState(true,true);b.disconnect()}},settings:{update:function e(t){var n=t.target,r=n.id,i=n.value;g.update(r,i)}},onKeyUpPattern:function e(t){k.changePattern(t.target.value)},onKeyDownPattern:function e(t){if(t.keyCode===13){t.preventDefault();t.stopPropagation();var n=t.target.value;if(m.instrument.changePattern(n)){k.commitPattern(n)}}}};window.addEventListener("keydown",function(e){var t=e.keyCode,n=e.shiftKey;if(n){k.changeView(t-49)}if(t===13){if(k.getCurrentView()==="main-view"){k.focusPattern()}}})},34:function(e,t){},35:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s={};var o=function(){function e(t){i(this,e);this.options=Object.assign({},s,t);this.network=null}r(e,[{key:"send",value:function e(t,n){if(!this.network){return}var r={type:t};if(typeof n!=="undefined"){r.value=n}this.network.sendToAll(r)}},{key:"receive",value:function e(t,n){if(!n.type){return}}},{key:"setNetwork",value:function e(t){this.network=t}}]);return e}();t.default=o;e.exports=t["default"]},36:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(37);var s=u(i);var o=n(50);var a=n(51);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=(0,o.pickFromScale)([6,1,2,4,5],o.PELOG);var l=80;var h=a.PRESETS.BELL;var v=.25;var p=[0,1];var d={};function y(e){return e[Math.floor(Math.random()*e.length)]}var m=function(){function e(t){c(this,e);this.options=Object.assign({},d,t);this.instrument=new s.default({baseBpm:l,noteMaterial:f});this.instrument.changePreset(h);this.instrument.changeVelocity(v);this.interval=null}r(e,[{key:"getCurrentPattern",value:function e(){return this.instrument.settings.patternString}},{key:"start",value:function e(){var t=this;this.instrument.start();this.interval=setInterval(function(){if(Math.random()<.5){return}t.instrument.changeOctave(y(p))},1e4)}},{key:"stop",value:function e(){this.instrument.stop();clearInterval(this.interval)}}]);return e}();t.default=m;e.exports=t["default"]},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(38);var s=c(i);var o=n(39);var a=c(o);var u=n(49);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=1e3;var h=60;var v=16;var p={baseBpm:120,noteMaterial:[]};function d(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:6e4;var t=arguments[1];var n=arguments[2];return e/t*(1/n)*4}var y=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};f(this,e);this.options=Object.assign({},p,t);this.lastTickSyncAt=null;this.stepFrequency=null;this.tickTimeout=null;this.settings={bpm:this.options.baseBpm,octave:0,patternString:"",velocity:1};this.synthesizerInterface=new a.default;this.sequencer=new s.default(this.synthesizerInterface)}r(e,[{key:"isRunning",value:function e(){return this.sequencer.isRunning}},{key:"changePreset",value:function e(t){this.synthesizerInterface.changePreset(t)}},{key:"changeBpm",value:function e(t){this.settings.bpm=t}},{key:"changeOctave",value:function e(t){this.settings.octave=t}},{key:"changeVelocity",value:function e(t){this.settings.velocity=t}},{key:"changePattern",value:function e(t){this.settings.patternString=t;var n=(0,u.convertString)(this.settings.patternString,this.settings.octave,this.settings.velocity,this.options.noteMaterial);if(!n){return false}var r=this.options.baseBpm*Math.pow(2,n.bpmLevel);this.changeBpm(r);this.sequencer.changePattern(n.pattern);return true}},{key:"step",value:function e(){var t=this;this.sequencer.step();this.tickTimeout=setTimeout(function(){t.step()},this.stepFrequency)}},{key:"syncTick",value:function e(){var t=(new Date).getTime();var n=this.lastTickSyncAt?t-this.lastTickSyncAt.getTime():l;var r=h*n;this.stepFrequency=d(r,this.settings.bpm,v);this.lastTickSyncAt=new Date;if(!this.tickTimeout){this.step()}}},{key:"start",value:function e(){this.sequencer.start()}},{key:"stop",value:function e(){this.sequencer.stop();clearTimeout(this.tickTimeout);this.tickTimeout=null;this.lastTickSyncAt=null;this.lastPatternSyncAt=null;this.stepFrequency=null}}]);return e}();t.default=y;e.exports=t["default"]},38:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=function(){function e(t){i(this,e);this.synthesizerInterface=t;this.currentStep=null;this.currentStepIndex=0;this.previousStep=null;this.pattern=[];this.isRunning=false}r(e,[{key:"step",value:function e(){if(!this.isRunning){return}if(this.pattern.length===0){return}var t=this.pattern[this.currentStepIndex],n=t.isHolding,r=t.note,i=t.velocity;var s=this.previousStep&&this.previousStep.note;if(s&&(s!==r||!n)){this.synthesizerInterface.noteOff(s)}if(r&&(r!==s||!n)){this.synthesizerInterface.noteOn(r,i)}this.previousStep=this.pattern[this.currentStepIndex];this.currentStepIndex+=1;if(this.currentStepIndex>this.pattern.length-1){this.currentStepIndex=0}}},{key:"start",value:function e(){this.isRunning=true}},{key:"stop",value:function e(){this.isRunning=false;this.currentStepIndex=0;this.previousStep=null;this.synthesizerInterface.allNotesOff()}},{key:"changePattern",value:function e(t){this.pattern=t;if(this.isRunning){if(this.currentStepIndex>this.pattern.length-1){this.currentStepIndex=0}this.previousStep=null;this.synthesizerInterface.allNotesOff()}}}]);return e}();t.default=s;e.exports=t["default"]},39:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(40);var s=f(i);var o=n(42);var a=f(o);var u=n(43);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var h=72;var v=1;var p=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};l(this,e);this.audio=new s.default;this.channels=[];this.preset=t.preset}r(e,[{key:"changePreset",value:function e(t){this.preset=t}},{key:"noteOn",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:h;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:v;var r=new c.default({preset:this.preset,sampleRate:this.audio.context.sampleRate});var i=new a.default(this.audio,r,t);i.start();this.channels.push(i);r.noteOn(t,n)}},{key:"noteOff",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:h;var r=this.channels.findIndex(function(e){return e.note===n});if(r===-1){throw new Error("Could not find that note")}var i=this.channels[r];i.note=null;i.synthesizer.noteOff().then(function(){i.stop();t.channels.splice(t.channels.findIndex(function(e){return e===i}),1)})}},{key:"allNotesOff",value:function e(){var t=this;this.channels.forEach(function(e){if(e.note){t.noteOff(e.note)}})}}]);return e}();t.default=p;e.exports=t["default"]},40:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(41);var s=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",s.default,true);r.responseType="arraybuffer";r.onload=function(){var i=r.response;e.decodeAudioData(i,function(e){t(e)},function(e){n(e)})};r.send()})}var c=function(){function e(){var t=this;a(this,e);this.context=new AudioContext;this.convolverNode=this.context.createConvolver();this.convolverNode.loop=true;this.convolverNode.normalize=true;u(this.context).then(function(e){t.convolverNode.buffer=e});this.compressorNode=this.context.createDynamicsCompressor();this.currentVolume=.5;this.gainNode=this.context.createGain();this.gainNode.gain.value=this.currentVolume;this.compressorNode.connect(this.gainNode);this.gainNode.connect(this.context.destination)}r(e,[{key:"changeVolume",value:function e(t){this.gainNode.gain.value=t;this.currentVolume=t}},{key:"mute",value:function e(){this.gainNode.gain.value=0}},{key:"unmute",value:function e(){this.gainNode.gain.value=this.currentVolume}}]);return e}();t.default=c;e.exports=t["default"]},41:function(e,t,n){e.exports=n.p+"cce8145a91d99c7379b34bf23fce576a.wav"},42:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=1024;var o=function(){function e(t,n,r){i(this,e);this.audioInterface=t;this.isRunning=false;this.note=r;this.scriptProcessorNode=null;this.synthesizer=n}r(e,[{key:"start",value:function e(){var t=this;if(this.isRunning){throw new Error("Channel was already started")}var n=this.audioInterface,r=n.context,i=n.compressorNode;this.scriptProcessorNode=r.createScriptProcessor(s,1,2);var o=r.createBufferSource();o.start(0);o.connect(this.scriptProcessorNode);this.scriptProcessorNode.connect(i);this.scriptProcessorNode.onaudioprocess=function(e){var n=e.outputBuffer.getChannelData(0);var r=e.outputBuffer.getChannelData(1);t.synthesizer.generateAudio(n,r)};this.isRunning=true}},{key:"stop",value:function e(){if(!this.isRunning){throw new Error("Channel was already stopped")}this.scriptProcessorNode.disconnect();this.isRunning=false}}]);return e}();t.default=o;e.exports=t["default"]},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(44);var s=n(45);var o=n(46);var a=u(o);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=16e3;var l=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};c(this,e);if(!t||!t.preset){throw new Error("Preset option is not set")}this.sampleRate=t.sampleRate||f;this.velocity=1;this.feedback=0;this.algorithmId=0;this.operators=[];for(var n=0;n<4;n+=1){this.operators.push(new a.default)}this.changePreset(t.preset)}r(e,[{key:"generateAudio",value:function e(t,n){var r=this;var s=t.length;var o=i.ALGORITHMS[this.algorithmId];for(var a=0;a<s;a+=1){var u=0;var c=function e(t){var n=0;var i=r.operators[t];r.operators.forEach(function(e,i){n+=o[t][i]*r.operators[i]._output});n*=10;if(t===3){n+=i._output*r.feedback*3}var s=i.envelope.amp;i._output=Math.sin(i._phase+n)*s*s;if(i.isVelocitySensitive){i._output*=r.velocity}i._phase+=i._phaseIncrement;u+=i._output*o[4][t]};for(var f=this.operators.length-1;f>=0;f-=1){c(f)}n[a]=t[a]=u;this.operators.forEach(function(e){e.next()})}}},{key:"noteOn",value:function e(t,n){var r=this;this.velocity=n;this.operators.forEach(function(e){var n=(0,s.calculateRatioFrequency)(e.coarse,e.fine);e._phaseIncrement=(0,s.calculatePhaseIncrement)(t,r.sampleRate)*n;e._phase=0;e._output=0});this.operators.forEach(function(e){e.noteOn()})}},{key:"noteOff",value:function e(){var t=this;return new Promise(function(e){var n=t.operators.length;t.operators.forEach(function(t){t.envelope.onRelease=function(){n-=1;if(n===0){e()}};t.noteOff()})})}},{key:"changeOperator",value:function e(t,n){if(t<0||t>this.operators.length-1){return}this.operators[t].coarse=n.coarse;this.operators[t].fine=n.fine;this.operators[t].isFixed=n.isFixed;this.operators[t].isVelocitySensitive=n.isVelocitySensitive;this.operators[t].changeEnvelope(n.envelope)}},{key:"changePreset",value:function e(t){var n=this;var r=(0,s.convertOperatorSettings)(t,this.sampleRate);this.feedback=r.feedback;this.algorithmId=r.algorithmId;r.operators.forEach(function(e,t){n.changeOperator(t,e)})}}]);return e}();t.default=l;e.exports=t["default"]},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=t.ALGORITHMS=[[[0,1,0,0],[0,0,1,0],[0,0,0,1],[0,0,0,0],[1,0,0,0]],[[0,1,0,0],[0,0,1,1],[0,0,0,0],[0,0,0,0],[1,0,0,0]],[[0,1,0,1],[0,0,1,0],[0,0,0,0],[0,0,0,0],[1,0,0,0]],[[0,1,1,0],[0,0,0,0],[0,0,0,1],[0,0,0,0],[1,0,0,0]],[[0,1,0,0],[0,0,0,0],[0,0,0,1],[0,0,0,0],[.5,0,.5,0]],[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,0],[.33,.33,.33,0]],[[0,0,0,0],[0,0,0,0],[0,0,0,1],[0,0,0,0],[.33,.33,.33,0]],[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[.25,.25,.25,.25]]]},45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.calculatePhaseIncrement=r;t.calculateRatioFrequency=i;t.convertOperatorSettings=s;function r(e,t){return 2*Math.PI*e/t}function i(e,t){var n=Math.ceil(e*13);if(n===0){n=.5}n+=t>=1?.99:t;return n}function s(e,t){var n=e.algorithmId,r=e.feedback;var i=15*t;var s=[];var o=function t(n){var r={isLoop:e.isLoop[n]};r.segments=e.envelopes[n].map(function(t,r){var s=void 0;var o=void 0;if(r===0){s=Math.pow(t.x,2)*i;if(s===0){s=1}o=(1-t.y)/s}else if(r===1){var a=e.envelopes[n][0];s=Math.pow(t.x-a.x,2)*i;if(s===0){s=1}o=-1*(t.y-a.y)/s}else if(r===2){s=Math.pow(1-t.x,2)*i;if(s===0){s=1}o=-1*(1-t.y)/s}return{length:s,step:o}});s.push({isVelocitySensitive:e.isVelocitySensitive[n],coarse:e.coarse[n],fine:e.fine[n],envelope:r})};for(var a=0;a<4;a+=1){o(a)}return{algorithmId:n,feedback:r,operators:s}}},46:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(47);var s=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=function(){function e(){a(this,e);this.envelope=new s.default;this.coarse=0;this.fine=0;this.isVelocitySensitive=false;this._output=0;this._phase=0;this._phaseIncrement=0}r(e,[{key:"next",value:function e(){return this.envelope.next()}},{key:"noteOn",value:function e(){return this.envelope.noteOn()}},{key:"noteOff",value:function e(){return this.envelope.noteOff()}},{key:"changeEnvelope",value:function e(t){var n=this;this.envelope.isLoop=t.isLoop;t.segments.forEach(function(e,t){n.envelope.changeSegment(t,e)})}}]);return e}();t.default=u;e.exports=t["default"]},47:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(48);var s=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u={STOP:0,ATTACK:1,DECAY:2,SUSTAIN:3,RELEASE:4,DUMP:5};var c=function(){function e(){a(this,e);this.state=u.STOP;this.amp=0;this.isLoop=false;this.segments=[];this.currentSegmentPosition=0;this.currentSegmentStep=0;this.onRelease=function(){return true};for(var t=0;t<3;t+=1){this.segments.push(new s.default)}}r(e,[{key:"next",value:function e(){if(this.currentSegmentPosition<=0){return}this.amp+=this.currentSegmentStep;if(this.amp>1){this.amp=1}this.currentSegmentPosition-=1;if(this.currentSegmentPosition<=0){switch(this.state){case u.DUMP:this.state=u.ATTACK;this.currentSegmentStep=this.segments[0].step;this.currentSegmentPosition=this.segments[0].length;this.amp=0;break;case u.ATTACK:this.state=u.DECAY;this.currentSegmentStep=this.segments[1].step;this.currentSegmentPosition=this.segments[1].length;break;case u.DECAY:if(!this.isLoop){this.state=u.SUSTAIN;this.currentSegmentStep=0;this.currentSegmentPosition=0}else{this.state=u.ATTACK;this.currentSegmentStep=this.segments[0].step;this.currentSegmentPosition=this.segments[0].length;this.amp=0}break;case u.RELEASE:this.state=u.STOP;this.amp=0;if(this.onRelease){this.onRelease()}break}}}},{key:"noteOn",value:function e(){if(this.state!==u.STOP){this.state=u.DUMP;this.currentSegmentStep=-1*this.amp/this.currentSegmentPosition;this.currentSegmentPosition=128}else{this.state=u.ATTACK;this.currentSegmentStep=this.segments[0].step;this.currentSegmentPosition=this.segments[0].length;this.amp=0}}},{key:"noteOff",value:function e(){if(this.state!==u.STOP){this.state=u.RELEASE;this.currentSegmentStep=-1*this.amp/this.segments[2].length;this.currentSegmentPosition=this.segments[2].length}}},{key:"changeSegment",value:function e(t,n){if(t<0||t>this.segments.length-1){throw new Error("Invalid segment index")}this.segments[t].length=n.length;this.segments[t].step=n.step}}]);return e}();t.default=c;e.exports=t["default"]},48:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=function e(){r(this,e);this.length=0;this.step=0};t.default=i;e.exports=t["default"]},49:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.convertString=l;var r="*";var i=[".","-","_",":","/"];var s=" ";var o=">";var a="<";function u(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var n=arguments[2];var o=arguments[3];var a=e.toLowerCase().split("");if(a.length===0){return[]}var u=null;var c=false;var f=a.map(function(e){var a=null;var f=false;if(e===r){if(!u){c=true;return false}a=u;f=true}else if(e===s){u=null}else if(i.includes(e)){var l=i.indexOf(e);a=o[l]*Math.pow(2,t);u=a}else{c=true;return false}return{isHolding:f,note:a,velocity:a?n:0}});if(c){return false}return f}function c(e,t){var n=new RegExp(t,"g");return(e.match(n)||[]).length}function f(e){var t=c(e,o);var n=c(e,a);return t-n}function l(e,t,n,r){var i=f(e);var s=u(e.replace(/(<|>)/g,""),t,n,r);if(!s){return false}return{bpmLevel:i,pattern:s}}},50:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.pickFromScale=s;var r=t.SLENDRO=[240.6055948894539,274.7914006625929,316.56538760240016,368.28862969288394,420.13030572053793,482.6029910656113,551.1723529945722];var i=t.PELOG=[298.7979376420033,329.6275569129,358.4247322079921,420.13030572053793,452.10885997355683,482.6029910656113,533.9372457958401];function s(e,t){return e.map(function(e){return t[e]})}},51:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=t.PRESETS={BELL:{name:"BELL",algorithmId:4,coarse:[.04,.19,.06,.18],feedback:.3,fine:[0,.5,0,.5],isLoop:[false,false,false,false],isVelocitySensitive:[true,true,true,true],envelopes:[[{x:0,y:.053},{x:.708,y:.741},{x:.708,y:.741}],[{x:0,y:.435},{x:.741,y:.729},{x:.741,y:.729}],[{x:.004,y:.562},{x:.226,y:.832},{x:.708,y:.832}],[{x:.004,y:.461},{x:.281,y:.814},{x:.715,y:.814}]]},CHIME:{name:"CHIME",algorithmId:5,coarse:[.28,.07,.66,.05],feedback:.3,fine:[.29,0,0,0],isLoop:[false,false,false,true],isVelocitySensitive:[true,true,false,true],envelopes:[[{x:.004,y:0},{x:.752,y:.653},{x:.752,y:.653}],[{x:0,y:.524},{x:.285,y:.7},{x:.752,y:.7}],[{x:0,y:.829},{x:.288,y:.994},{x:.9,y:.994}],[{x:.077,y:.824},{x:.161,y:.994},{x:.9,y:.994}]]},PAD:{name:"PAD",algorithmId:4,coarse:[.05,.07,.13,.05],feedback:.94,fine:[0,0,.33,.5],isLoop:[false,false,false,false],isVelocitySensitive:[true,false,false,false],envelopes:[[{x:.062,y:.106},{x:.237,y:0},{x:.752,y:0}],[{x:.139,y:.776},{x:.328,y:.741},{x:.752,y:.741}],[{x:.131,y:.5},{x:.354,y:.288},{x:.704,y:.288}],[{x:.077,y:.618},{x:.201,y:.524},{x:.741,y:.524}]]},SPACE:{name:"SPACE",algorithmId:5,coarse:[.19,.41,.24,.14],feedback:.58,fine:[0,0,0,.5],isLoop:[true,true,true,true],isVelocitySensitive:[false,false,false,false],envelopes:[[{x:.212,y:.253},{x:.423,y:.994},{x:.752,y:.994}],[{x:.142,y:.541},{x:.281,y:.982},{x:.752,y:.982}],[{x:.354,y:.106},{x:.704,y:.994},{x:.704,y:.994}],[{x:.423,y:.276},{x:.861,y:.994},{x:.861,y:.994}]]},PING:{name:"PING",algorithmId:6,coarse:[0,.05,.17,.59],feedback:.19,fine:[0,.5,.5,0],isLoop:[false,false,false,false],isVelocitySensitive:[true,true,true,true],envelopes:[[{x:.07,y:.547},{x:.314,y:.994},{x:.752,y:.994}],[{x:.1,y:.735},{x:.423,y:.788},{x:.847,y:.788}],[{x:0,y:.488},{x:.058,y:.794},{x:.73,y:.794}],[{x:0,y:.665},{x:.069,y:.818},{x:.734,y:.818}]]},GUITAR:{name:"GUITAR",algorithmId:0,coarse:[0,.05,.17,.59],feedback:.19,fine:[0,.5,.5,0],isLoop:[false,false,false,false],isVelocitySensitive:[true,false,false,true],envelopes:[[{x:.05,y:.547},{x:.314,y:.994},{x:.752,y:.994}],[{x:0,y:.735},{x:.423,y:.788},{x:.847,y:.788}],[{x:.01,y:.488},{x:.058,y:.794},{x:.73,y:.794}],[{x:0,y:.665},{x:.069,y:.818},{x:.734,y:.818}]]}}},52:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(13);var s=a(i);var o=n(17);function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=1e4;var f="automaton-peer";function l(e){return f+"-"+e}function h(e,t){var n=[];for(var r=1;r<e+1;r+=1){if(t!==r){n.push(l(r))}}return n}function v(e){return e&&e.filter(function(e){return e.open})[0]}var p={onAllOnline:function e(){},onClose:function e(){},onCloseRemote:function e(){},onError:function e(){},onOpen:function e(){},onOpenRemote:function e(){},onReceive:function e(){},onSyncTick:function e(){},syncInterval:500,syncStepsDelay:100,syncTickFrequency:1};var d=function(){function e(t){u(this,e);this.options=Object.assign({},p,t);this.lastCheckedDate=new Date;this.offset=0;this.peer=null;this.peers=[];this.sync=null;this.syncInterval=null;this.syncTickInterval=null}r(e,[{key:"isAlone",value:function e(){var t=this;return this.peers.filter(function(e){if(v(t.peer.connections[e])){return true}return false}).length===0}},{key:"connect",value:function e(t){var n=this;if(this.peer&&this.peer.open){this.options.onError(new Error("Connection is already open"));return false}var r=t.serverHost,i=t.serverKey;var a=parseInt(t.peerId,10);var u=parseInt(t.clientsNumber,10);var f=parseInt(t.serverPort,10);if(a<1||a>u){this.options.onError(new Error("Invalid peer id"));return false}this.peers=h(u,a);this.lastCheckedDate=new Date;var p=function e(t){if(n.peer.connections[t.id]){var r=n.peer.connections[t.id].find(function(e){return e.open});if(r){return}}t.on("open",function(){n.options.onOpenRemote(t.peer);var e=n.peers.filter(function(e){if(v(n.peer.connections[e])){return true}return false});if(e.length===n.peers.length){n.options.onAllOnline()}}).on("data",function(e){if(e.jsonrpc){n.sync.receive(t.peer,e)}else{n.options.onReceive(t.peer,e)}}).on("close",function(){n.options.onCloseRemote(t.peer)}).on("error",function(e){n.options.onError(e)})};var d=function e(){n.peers.filter(function(e){return!(e in n.peer.connections)}).forEach(function(e){var t=n.peer.connect(e,{serialization:"json"});p(t)})};this.peer=new s.default(l(a),{host:r,key:i,port:f,secure:window.location.protocol==="https:"});this.peer.on("open",function(){d();n.options.onOpen()});this.peer.on("connection",function(e){p(e)});this.peer.on("disconnected",function(){n.peer.destroy();n.sync.destroy()});this.peer.on("close",function(){n.options.onClose()});this.peer.on("error",function(e){n.options.onError(e);if(e.type!=="disconnected"&&e.type!=="peer-unavailable"){n.disconnect(true)}});this.sync=(0,o.create)({delay:this.options.syncStepsDelay,interval:this.options.syncInterval,peers:[],timeout:1e4});this.sync.send=function(e,t){n.send(e,t)};this.sync.on("sync",function(e){if(e==="start"){var t=Object.keys(n.peer.connections).filter(function(e){return n.peer.connections[e].some(function(e){return e.open})});n.sync.options.peers=t}else if(e==="end"){n.sync.options.peers=[]}});this.sync.on("change",function(e){n.offset=e});this.syncInterval=setInterval(d,c);this.syncTickInterval=setInterval(function(){var e=new Date(n.sync.now());if(e.getSeconds()!==n.lastCheckedDate.getSeconds()){n.options.onSyncTick(n.offset);n.lastCheckedDate=e}},this.options.syncTickFrequency);return true}},{key:"disconnect",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!t&&(!this.peer||!this.peer.open)){throw new Error("Connection is already closed")}this.peer.disconnect();clearInterval(this.syncInterval);clearInterval(this.syncTickInterval);this.syncTickInterval=null;this.syncInterval=null}},{key:"sendToAll",value:function e(t){var n=this;this.peers.forEach(function(e){n.send(e,t)})}},{key:"send",value:function e(t,n){var r=v(this.peer.connections[t]);if(r){r.send(n)}}}]);return e}();t.default=d;e.exports=t["default"]},87:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s="automaton";function o(){var e=window.localStorage.getItem(s);return e?JSON.parse(e):{}}function a(e){window.localStorage.setItem(s,JSON.stringify(e))}var u={clientsNumber:4,peerId:1,serverHost:"0.peerjs.com",serverKey:"gs5wl7sq2cblnmi",serverPort:9e3};var c=function(){function e(){i(this,e);this.configuration=Object.assign({},u,o())}r(e,[{key:"update",value:function e(t,n){this.configuration[t]=n;a(this.configuration)}},{key:"getConfiguration",value:function e(){return this.configuration}}]);return e}();t.default=c;e.exports=t["default"]},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=3;var o=["main-view","settings-view"];var a="settings-view";var u=function(){function e(){i(this,e);this.allFormElems=document.querySelectorAll("form input");this.connectButtonElem=document.getElementById("connect-button");this.connectedPeersElem=document.getElementById("connected-peers");this.disconnectButtonElem=document.getElementById("disconnect-button");this.errorMessagesElem=document.getElementById("error-messages");this.offsetMonitorElem=document.getElementById("offset-monitor");this.patternElem=document.getElementById("pattern");this.tickElem=document.getElementById("tick");this.errorMessages=[];this.committedPattern=null;this.changeView(o.indexOf(a))}r(e,[{key:"getCurrentView",value:function e(){return document.querySelector(".view--active").id}},{key:"changeConnectionState",value:function e(t,n){this.connectButtonElem.disabled=t||n;this.disconnectButtonElem.disabled=t||!n;for(var r=0;r<this.allFormElems.length;r++){this.allFormElems[r].disabled=t||n}}},{key:"updateSettings",value:function e(t){Object.keys(t).forEach(function(e){var n=document.getElementById(e);if(n){n.value=t[e]}})}},{key:"updateOffset",value:function e(t){this.offsetMonitorElem.innerText=t.toFixed(1)+" ms"}},{key:"addErrorMessage",value:function e(t){var n=this;this.errorMessages.push({timestamp:new Date,message:t});if(this.errorMessages.length>s){this.errorMessages.shift()}this.errorMessagesElem.innerHTML="";this.errorMessages.forEach(function(e){var t=document.createElement("div");var r=e.timestamp.toISOString();t.innerText=r+" "+e.message;n.errorMessagesElem.appendChild(t)})}},{key:"addRemotePeer",value:function e(t){var n=document.createElement("div");n.class="connected-peer";n.innerText=t;n.id=t;this.connectedPeersElem.appendChild(n)}},{key:"removeRemotePeer",value:function e(t){var n=document.getElementById(t);this.connectedPeersElem.removeChild(n)}},{key:"changeView",value:function e(t){if(t<0||t>o.length-1){return}o.forEach(function(e){document.getElementById(e).classList.remove("view--active")});var n=o[t];document.getElementById(n).classList.add("view--active");this.patternElem.blur()}},{key:"changePattern",value:function e(t){var n=this.committedPattern&&this.committedPattern!==t;if(!this.committedPattern){this.committedPattern=t}this.patternElem.value=t;if(n){this.patternElem.classList.add("space__input--dirty")}else{this.patternElem.classList.remove("space__input--dirty")}}},{key:"focusPattern",value:function e(){this.patternElem.focus()}},{key:"commitPattern",value:function e(t){var n=this;this.patternElem.classList.remove("space__input--dirty");this.patternElem.classList.add("space__input--commit");setTimeout(function(){n.patternElem.classList.remove("space__input--commit")},500);this.committedPattern=t}},{key:"tick",value:function e(){var t=this;this.tickElem.classList.add("tick--active");setTimeout(function(){t.tickElem.classList.remove("tick--active")},500)}}]);return e}();t.default=u;e.exports=t["default"]}},[32]);
//# sourceMappingURL=automaton.bundle.js.map