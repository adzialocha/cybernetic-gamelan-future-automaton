webpackJsonp([0],[,,,,,,,,,,,,,function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=n(45);Object.defineProperty(t,"ALGORITHMS",{enumerable:true,get:function e(){return r.ALGORITHMS}});var i=n(46);Object.defineProperty(t,"FIXED_FREQUENCY_TABLE",{enumerable:true,get:function e(){return i.FIXED_FREQUENCY_TABLE}})},,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(35)},function(e,t,n){"use strict";var r=n(13);var i=v(r);var s=n(36);var o=v(s);var a=n(52);var u=v(a);var c=n(87);var f=v(c);var l=n(88);var h=v(l);function v(e){return e&&e.__esModule?e:{default:e}}var p=new o.default;var d=new f.default;var y=new h.default;var m=new u.default({onOpen:function e(){y.changeConnectionState(false,true)},onClose:function e(){y.changeConnectionState(false,false)},onOpenRemote:function e(t){y.addRemotePeer(t)},onCloseRemote:function e(t){y.removeRemotePeer(t)},onSyncTick:function e(t){y.updateOffset(t);y.tick()},onError:function e(t){y.addErrorMessage(t.message)}});window.addEventListener("load",function(){y.changeConnectionState(false,false);y.updateSettings(d.getConfiguration())});window.automaton=window.automaton||{network:{connect:function e(t){t.preventDefault();if(m.connect(d.getConfiguration())){y.changeConnectionState(true,false)}},disconnect:function e(t){t.preventDefault();y.changeConnectionState(true,true);m.disconnect()},send:function e(t){m.sendToAll(t)}},settings:{update:function e(t){var n=t.target,r=n.id,i=n.value;d.update(r,i)}},debug:p};window.addEventListener("keydown",function(e){var t=e.keyCode,n=e.shiftKey;if(n){y.changeView(t-49)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(13);var s=c(i);var o=n(37);var a=c(o);var u=n(51);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=function(){function e(){f(this,e);this.instrument=new a.default({preset:u.PRESETS.BELL,noteMaterial:[62,65,70,72,74]})}r(e,[{key:"changePattern",value:function e(t,n,r,i,s){this.instrument.changePattern(t,n,r,i,s)}},{key:"start",value:function e(){this.instrument.start()}},{key:"stop",value:function e(){this.instrument.stop()}},{key:"noteOn",value:function e(t,n){this.instrument.synthesizerInterface.noteOn(t,n)}},{key:"noteOff",value:function e(t){this.instrument.synthesizerInterface.noteOff(t)}}]);return e}();t.default=l;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(38);var s=u(i);var o=n(40);var a=u(o);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};c(this,e);var n=t.noteMaterial,r=t.preset;this.synthesizerInterface=new a.default({preset:r});this.gamelan=new s.default({noteMaterial:n,synthesizerInterface:this.synthesizerInterface})}r(e,[{key:"changePreset",value:function e(t){this.synthesizerInterface.preset=t}},{key:"changePattern",value:function e(t,n,r,i,s){this.gamelan.changePattern(t,n,{bpm:r,octave:s,velocity:i})}},{key:"start",value:function e(){this.gamelan.start()}},{key:"stop",value:function e(){this.gamelan.stop()}}]);return e}();t.default=f;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(39);function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o={bpm:120,velocity:1,octave:0};var a=function(){function e(t){s(this,e);var n=t.noteMaterial,r=t.synthesizerInterface;this.noteMaterial=n;this.synthesizerInterface=r;this.settings=o;this.currentPartIndex=0;this.currentPart=null;this.pattern=[];this.timeout=null;this.isRunning=false}r(e,[{key:"playNext",value:function e(){var t=this;if(this.pattern.length===0){return}var n=this.pattern[this.currentPartIndex],r=n.duration,i=n.note,s=n.velocity;if(i){this.synthesizerInterface.noteOn(i,s)}this.timeout=setTimeout(function(){if(!t.isRunning){return}if(t.pattern.length===0){return}if(i){t.synthesizerInterface.noteOff(i)}t.currentPartIndex+=1;if(t.currentPartIndex>=t.pattern.length-1){t.currentPartIndex=0}t.playNext()},r)}},{key:"start",value:function e(){if(this.isRunning){throw new Error("Gamelan is already running")}this.currentPartIndex=0;this.isRunning=true;this.playNext()}},{key:"stop",value:function e(){if(!this.isRunning){throw new Error("Gamelan is already stopped")}clearTimeout(this.timeout);this.synthesizerInterface.allNotesOff();this.timeout=null;this.isRunning=false}},{key:"changePattern",value:function e(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};this.settings=Object.assign({},this.settings,r);this.pattern=(0,i.symbolsToPattern)(t,n,this.settings,this.noteMaterial);if(this.isRunning){clearTimeout(this.timeout);this.currentPartIndex=0;this.synthesizerInterface.allNotesOff();this.playNext()}}}]);return e}();t.default=a;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.symbolsToPattern=a;var r={".":16,_:8,"-":4,"/":2,"#":1};var i=6e4;var s="*";function o(e,t){return i/e*(1/t)*4}function a(e,t,n,i){if(e.length!==t.length){throw new Error("Notes and duration string need the same length")}var a=n.octave,u=n.bpm,c=n.velocity;var f=e.split("");var l=t.split("");return f.map(function(e,t){var n=l[t];if(!Object.keys(r).includes(n)){throw new Error("Unknown duration symbol")}var f=o(u,r[n]);var h=null;if(e!==s){var v=parseInt(e,10);if(isNaN(v)||v<1||v>i.length){throw new Error("Unknown note symbol")}h=i[v-1]+12*a}return{note:h,duration:f,velocity:c}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(41);var s=f(i);var o=n(43);var a=f(o);var u=n(44);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var h=72;var v=1;var p=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};l(this,e);this.audio=new s.default;this.channels=[];this.preset=t.preset}r(e,[{key:"changePreset",value:function e(t){this.preset=t}},{key:"noteOn",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:h;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:v;var r=new c.default({preset:this.preset,sampleRate:this.audio.context.sampleRate});var i=new a.default(this.audio,r,t);i.start();this.channels.push(i);r.noteOn(t,n)}},{key:"noteOff",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:h;var r=this.channels.findIndex(function(e){return e.note===n});if(r===-1){throw new Error("Could not find that note")}var i=this.channels[r];i.note=null;i.synthesizer.noteOff().then(function(){i.stop();t.channels.splice(t.channels.findIndex(function(e){return e===i}),1)})}},{key:"allNotesOff",value:function e(){var t=this;this.channels.forEach(function(e){if(e.note){t.noteOff(e.note)}})}}]);return e}();t.default=p;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(42);var s=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",s.default,true);r.responseType="arraybuffer";r.onload=function(){var i=r.response;e.decodeAudioData(i,function(e){t(e)},function(e){n(e)})};r.send()})}var c=function(){function e(){var t=this;a(this,e);this.context=new AudioContext;this.convolverNode=this.context.createConvolver();this.convolverNode.loop=true;this.convolverNode.normalize=true;u(this.context).then(function(e){t.convolverNode.buffer=e});this.compressorNode=this.context.createDynamicsCompressor();this.currentVolume=1;this.gainNode=this.context.createGain();this.gainNode.gain.value=this.currentVolume;this.compressorNode.connect(this.convolverNode);this.convolverNode.connect(this.gainNode);this.gainNode.connect(this.context.destination)}r(e,[{key:"changeVolume",value:function e(t){this.gainNode.gain.value=t;this.currentVolume=t}},{key:"mute",value:function e(){this.gainNode.gain.value=0}},{key:"unmute",value:function e(){this.gainNode.gain.value=this.currentVolume}}]);return e}();t.default=c;e.exports=t["default"]},function(e,t,n){e.exports=n.p+"cce8145a91d99c7379b34bf23fce576a.wav"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=function(){function e(t,n,r){i(this,e);this.audioInterface=t;this.isRunning=false;this.note=r;this.scriptProcessorNode=null;this.synthesizer=n}r(e,[{key:"start",value:function e(){var t=this;if(this.isRunning){throw new Error("Channel was already started")}var n=this.audioInterface,r=n.context,i=n.compressorNode;this.scriptProcessorNode=r.createScriptProcessor();var s=r.createBufferSource();s.start(0);s.connect(this.scriptProcessorNode);this.scriptProcessorNode.connect(i);this.scriptProcessorNode.onaudioprocess=function(e){var n=e.outputBuffer.getChannelData(0);var r=e.outputBuffer.getChannelData(1);t.synthesizer.generateAudio(n,r)};this.isRunning=true}},{key:"stop",value:function e(){if(!this.isRunning){throw new Error("Channel was already stopped")}this.scriptProcessorNode.disconnect();this.isRunning=false}}]);return e}();t.default=s;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(14);var s=n(47);var o=n(48);var a=u(o);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=16e3;var l=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};c(this,e);if(!t||!t.preset){throw new Error("Preset option is not set")}this.sampleRate=t.sampleRate||f;this.velocity=1;this.feedback=0;this.algorithmId=0;this.operators=[];for(var n=0;n<4;n+=1){this.operators.push(new a.default)}this.changePreset(t.preset)}r(e,[{key:"generateAudio",value:function e(t,n){var r=this;var s=t.length;var o=i.ALGORITHMS[this.algorithmId];for(var a=0;a<s;a+=1){var u=0;var c=function e(t){var n=0;var i=r.operators[t];r.operators.forEach(function(e,i){n+=o[t][i]*r.operators[i]._output});n*=10;if(t===3){n+=i._output*r.feedback*3}var s=i.envelope.amp;i._output=Math.sin(i._phase+n)*s*s;if(i.isVelocitySensitive){i._output*=r.velocity}i._phase+=i._phaseIncrement;u+=i._output*o[4][t]};for(var f=this.operators.length-1;f>=0;f-=1){c(f)}n[a]=t[a]=u;this.operators.forEach(function(e){e.next()})}}},{key:"noteOn",value:function e(t,n){var r=this;this.velocity=n;this.operators.forEach(function(e){var n=void 0;if(e.isFixed){n=(0,s.calculateFixedFrequency)(e.coarse,e.fine);e._phaseIncrement=(0,s.calculatePhaseIncrement)(n,r.sampleRate)}else{n=(0,s.calculateRatioFrequency)(e.coarse,e.fine);e._phaseIncrement=(0,s.calculatePhaseIncrement)(440*Math.pow(2,(t-69)/12),r.sampleRate)*n}e._phase=0;e._output=0});this.operators.forEach(function(e){e.noteOn()})}},{key:"noteOff",value:function e(){var t=this;return new Promise(function(e){var n=t.operators.length;t.operators.forEach(function(t){t.envelope.onRelease=function(){n-=1;if(n===0){e()}};t.noteOff()})})}},{key:"changeOperator",value:function e(t,n){if(t<0||t>this.operators.length-1){return}this.operators[t].coarse=n.coarse;this.operators[t].fine=n.fine;this.operators[t].isFixed=n.isFixed;this.operators[t].isVelocitySensitive=n.isVelocitySensitive;this.operators[t].changeEnvelope(n.envelope)}},{key:"changePreset",value:function e(t){var n=this;var r=(0,s.convertOperatorSettings)(t,this.sampleRate);this.feedback=r.feedback;this.algorithmId=r.algorithmId;r.operators.forEach(function(e,t){n.changeOperator(t,e)})}}]);return e}();t.default=l;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=t.ALGORITHMS=[[[0,1,0,0],[0,0,1,0],[0,0,0,1],[0,0,0,0],[1,0,0,0]],[[0,1,0,0],[0,0,1,1],[0,0,0,0],[0,0,0,0],[1,0,0,0]],[[0,1,0,1],[0,0,1,0],[0,0,0,0],[0,0,0,0],[1,0,0,0]],[[0,1,1,0],[0,0,0,0],[0,0,0,1],[0,0,0,0],[1,0,0,0]],[[0,1,0,0],[0,0,0,0],[0,0,0,1],[0,0,0,0],[.5,0,.5,0]],[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,0],[.33,.33,.33,0]],[[0,0,0,0],[0,0,0,0],[0,0,0,1],[0,0,0,0],[.33,.33,.33,0]],[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[.25,.25,.25,.25]]]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=t.FIXED_FREQUENCY_TABLE=[1,1.023373891996775,1.0472941228206267,1.0717734625362931,1.096824979694626,1.122462048309373,1.148698354997035,1.1755479062836087,1.2030250360821166,1.2311444133449163,1.2599210498948732,1.2893703084395791,1.3195079107728942,1.3503499461681898,1.3819128799677758,1.4142135623730947,1.4472692374403777,1.4810975522865637,1.5157165665103975,1.551144761833734,1.587401051968199,1.6245047927124705,1.662475792285575,1.7013343219017112,1.7411011265922482,1.7817974362806785,1.8234449771164336,1.866065983073615,1.9096832078208332,1.954319936868492,2,2.04674778399355,2.0945882456412535,2.1435469250725867,2.1936499593892527,2.244924096618747,2.297396709994071,2.351095812567219,2.406050072164235,2.4622888266898344,2.5198420997897486,2.578740616879161,2.639015821545791,2.7006998923363827,2.7638257599355547,2.8284271247461925,2.8945384748807585,2.9621951045731305,3.0314331330207978,3.102289523667471,3.1748021039364005,3.2490095854249432,3.324951584571152,3.4026686438034237,3.4822022531844974,3.5635948725613575,3.646889954232867,3.7321319661472296,3.8193664156416656,3.908639873736983,3.999999999999999,4.093495567987098,4.189176491282505,4.287093850145171,4.387299918778502,4.489848193237489,4.594793419988137,4.702191625134431,4.812100144328463,4.924577653379661,5.039684199579487,5.157481233758311,5.2780316430915715,5.401399784672753,5.527651519871096,5.656854249492371,5.789076949761503,5.924390209146247,6.062866266041581,6.204579047334927,6.349604207872786,6.498019170849871,6.649903169142289,6.805337287606831,6.964404506368978,7.127189745122698,7.2937799084657176,7.4642639322944415,7.638732831283315,7.817279747473951,7.999999999999984,8.186991135974184,8.378352982565,8.574187700290333,8.774599837556996,8.979696386474973,9.18958683997627,9.404383250268861,9.624200288656926,9.849155306759325]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.calculatePhaseIncrement=i;t.calculateRatioFrequency=s;t.calculateFixedFrequency=o;t.convertOperatorSettings=a;var r=n(14);function i(e,t){return 2*Math.PI*e/t}function s(e,t){var n=Math.ceil(e*13);if(n===0){n=.5}n+=t>=1?.99:t;return n}function o(e,t){var n=Math.pow(10,Math.floor(e*3));var i=Math.floor(t*100);if(i>99){i=99}return r.FIXED_FREQUENCY_TABLE[i]*n}function a(e,t){var n=e.algorithmId,r=e.feedback;var i=15*t;var s=[];var o=function t(n){var r={isLoop:e.isLoop[n]};r.segments=e.envelopes[n].map(function(t,r){var s=void 0;var o=void 0;if(r===0){s=Math.pow(t.x,2)*i;if(s===0){s=1}o=(1-t.y)/s}else if(r===1){var a=e.envelopes[n][0];s=Math.pow(t.x-a.x,2)*i;if(s===0){s=1}o=-1*(t.y-a.y)/s}else if(r===2){s=Math.pow(1-t.x,2)*i;if(s===0){s=1}o=-1*(1-t.y)/s}return{length:s,step:o}});s.push({isFixed:e.isFixed[n],isVelocitySensitive:e.isVelocitySensitive[n],coarse:e.coarse[n],fine:e.fine[n],envelope:r})};for(var a=0;a<4;a+=1){o(a)}return{algorithmId:n,feedback:r,operators:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(49);var s=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=function(){function e(){a(this,e);this.envelope=new s.default;this.coarse=0;this.fine=0;this.isFixed=false;this.isVelocitySensitive=false;this._output=0;this._phase=0;this._phaseIncrement=0}r(e,[{key:"next",value:function e(){return this.envelope.next()}},{key:"noteOn",value:function e(){return this.envelope.noteOn()}},{key:"noteOff",value:function e(){return this.envelope.noteOff()}},{key:"changeEnvelope",value:function e(t){var n=this;this.envelope.isLoop=t.isLoop;t.segments.forEach(function(e,t){n.envelope.changeSegment(t,e)})}}]);return e}();t.default=u;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(50);var s=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u={STOP:0,ATTACK:1,DECAY:2,SUSTAIN:3,RELEASE:4,DUMP:5};var c=function(){function e(){a(this,e);this.state=u.STOP;this.amp=0;this.isLoop=false;this.segments=[];this.currentSegmentPosition=0;this.currentSegmentStep=0;this.onRelease=function(){return true};for(var t=0;t<3;t+=1){this.segments.push(new s.default)}}r(e,[{key:"next",value:function e(){if(this.currentSegmentPosition<=0){return}this.amp+=this.currentSegmentStep;if(this.amp>1){this.amp=1}this.currentSegmentPosition-=1;if(this.currentSegmentPosition<=0){switch(this.state){case u.DUMP:this.state=u.ATTACK;this.currentSegmentStep=this.segments[0].step;this.currentSegmentPosition=this.segments[0].length;this.amp=0;break;case u.ATTACK:this.state=u.DECAY;this.currentSegmentStep=this.segments[1].step;this.currentSegmentPosition=this.segments[1].length;break;case u.DECAY:if(!this.isLoop){this.state=u.SUSTAIN;this.currentSegmentStep=0;this.currentSegmentPosition=0}else{this.state=u.ATTACK;this.currentSegmentStep=this.segments[0].step;this.currentSegmentPosition=this.segments[0].length;this.amp=0}break;case u.RELEASE:this.state=u.STOP;this.amp=0;if(this.onRelease){this.onRelease()}break}}}},{key:"noteOn",value:function e(){if(this.state!==u.STOP){this.state=u.DUMP;this.currentSegmentStep=-1*this.amp/this.currentSegmentPosition;this.currentSegmentPosition=128}else{this.state=u.ATTACK;this.currentSegmentStep=this.segments[0].step;this.currentSegmentPosition=this.segments[0].length;this.amp=0}}},{key:"noteOff",value:function e(){if(this.state!==u.STOP){this.state=u.RELEASE;this.currentSegmentStep=-1*this.amp/this.segments[2].length;this.currentSegmentPosition=this.segments[2].length}}},{key:"changeSegment",value:function e(t,n){if(t<0||t>this.segments.length-1){throw new Error("Invalid segment index")}this.segments[t].length=n.length;this.segments[t].step=n.step}}]);return e}();t.default=c;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=function e(){r(this,e);this.length=0;this.step=0};t.default=i;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=t.PRESETS={BELL:{name:"BELL",algorithmId:4,coarse:[.04,.19,.06,.18],feedback:.3,fine:[0,.5,0,.5],isFixed:[false,false,false,false],isLoop:[false,false,false,false],isVelocitySensitive:[false,true,false,false],envelopes:[[{x:0,y:.053},{x:.708,y:.741},{x:.708,y:.741}],[{x:0,y:.435},{x:.741,y:.729},{x:.741,y:.729}],[{x:.004,y:.562},{x:.226,y:.832},{x:.708,y:.832}],[{x:.004,y:.461},{x:.281,y:.814},{x:.715,y:.814}]]},BRASS:{name:"BRASS",algorithmId:0,coarse:[.04,.07,0,.17],feedback:.28,fine:[0,0,0,0],isFixed:[false,false,false,false],isLoop:[false,false,false,false],isVelocitySensitive:[false,false,true,true],envelopes:[[{x:.102,y:.112},{x:.208,y:.324},{x:.9,y:.324}],[{x:.007,y:.747},{x:.219,y:.259},{x:.9,y:.259}],[{x:.073,y:.241},{x:.277,y:.476},{x:.9,y:.476}],[{x:0,y:.594},{x:.161,y:.994},{x:.9,y:.994}]]},ORGAN:{name:"ORGAN",algorithmId:7,coarse:[0,.11,.04,.25],feedback:.16,fine:[0,0,0,0],isFixed:[false,false,false,false],isLoop:[false,false,false,false],isVelocitySensitive:[false,false,false,false],envelopes:[[{x:.04,y:.012},{x:.215,y:0},{x:.9,y:0}],[{x:.047,y:.006},{x:.168,y:.006},{x:.9,y:.006}],[{x:.077,y:.076},{x:.161,y:0},{x:.836,y:0}],[{x:.088,y:.141},{x:.223,y:.006},{x:.9,y:.006}]]},CHIME:{name:"CHIME",algorithmId:1,coarse:[.28,.07,.66,.05],feedback:.3,fine:[.29,0,0,0],isFixed:[true,false,false,false],isLoop:[false,false,false,true],isVelocitySensitive:[false,false,true,false],envelopes:[[{x:.004,y:0},{x:.752,y:.653},{x:.752,y:.653}],[{x:0,y:.524},{x:.285,y:.7},{x:.752,y:.7}],[{x:0,y:.829},{x:.288,y:.994},{x:.9,y:.994}],[{x:.077,y:.824},{x:.161,y:.994},{x:.9,y:.994}]]},PAD:{name:"PAD",algorithmId:4,coarse:[.05,.07,.13,.05],feedback:.94,fine:[0,0,.33,.5],isFixed:[false,false,true,false],isLoop:[false,false,false,false],isVelocitySensitive:[false,false,false,false],envelopes:[[{x:.062,y:.106},{x:.237,y:0},{x:.752,y:0}],[{x:.139,y:.776},{x:.328,y:.741},{x:.752,y:.741}],[{x:.131,y:.5},{x:.354,y:.288},{x:.704,y:.288}],[{x:.077,y:.618},{x:.201,y:.524},{x:.741,y:.524}]]},EG_LOOPER:{name:"EG_LOOPER",algorithmId:4,coarse:[.19,.41,.24,.14],feedback:.58,fine:[0,0,0,.5],isFixed:[false,false,false,false],isLoop:[true,true,true,true],isVelocitySensitive:[false,false,false,false],envelopes:[[{x:.212,y:.253},{x:.423,y:.994},{x:.752,y:.994}],[{x:.142,y:.541},{x:.281,y:.982},{x:.752,y:.982}],[{x:.354,y:.106},{x:.704,y:.994},{x:.704,y:.994}],[{x:.423,y:.276},{x:.861,y:.994},{x:.861,y:.994}]]},GUITAR:{name:"GUITAR",algorithmId:0,coarse:[0,.05,.17,.59],feedback:.19,fine:[0,.5,.5,0],isFixed:[false,false,false,false],isLoop:[false,false,false,false],isVelocitySensitive:[false,false,false,true],envelopes:[[{x:0,y:.047},{x:.314,y:.994},{x:.752,y:.994}],[{x:0,y:.735},{x:.423,y:.788},{x:.847,y:.788}],[{x:0,y:.488},{x:.058,y:.794},{x:.73,y:.794}],[{x:0,y:.665},{x:.069,y:.818},{x:.734,y:.818}]]},EG_SEQ:{name:"EG_SEQ",algorithmId:2,coarse:[.05,0,.29,.14],feedback:.36,fine:[0,0,0,0],isFixed:[false,false,false,false],isLoop:[true,false,false,true],isVelocitySensitive:[false,false,false,false],envelopes:[[{x:.004,y:.029},{x:.109,y:.994},{x:.9,y:.994}],[{x:.004,y:.488},{x:.982,y:.994},{x:.982,y:.994}],[{x:.004,y:.506},{x:.124,y:.988},{x:.836,y:.988}],[{x:.434,y:.176},{x:.869,y:.988},{x:.9,y:.988}]]},INIT_VOICE:{name:"INIT_VOICE",algorithmId:0,coarse:[.05,.05,.05,.05],feedback:0,fine:[0,0,0,0],isFixed:[false,false,false,false],isLoop:[false,false,false,false],isVelocitySensitive:[false,false,false,false],envelopes:[[{x:0,y:.2},{x:.5,y:.2},{x:1,y:.2}],[{x:0,y:1},{x:.5,y:1},{x:1,y:1}],[{x:0,y:1},{x:.5,y:1},{x:1,y:1}],[{x:0,y:1},{x:.5,y:1},{x:1,y:1}]]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=n(15);var s=a(i);var o=n(19);function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=1e4;var f="automaton-peer";function l(e){return f+"-"+e}function h(e,t){var n=[];for(var r=1;r<e+1;r+=1){if(t!==r){n.push(l(r))}}return n}var v={onClose:function e(){},onCloseRemote:function e(){},onError:function e(){},onOpen:function e(){},onOpenRemote:function e(){},onReceive:function e(){},onSyncTick:function e(){},syncInterval:5e3,syncTickFrequency:10};var p=function(){function e(t){u(this,e);this.options=Object.assign({},v,t);this.lastCheckedDate=new Date;this.offset=0;this.peer=null;this.peers=[];this.sync=null;this.syncInterval=null;this.syncTickInterval=null}r(e,[{key:"connect",value:function e(t){var n=this;if(this.peer&&this.peer.open){this.options.onError(new Error("Connection is already open"));return false}var r=t.serverHost,i=t.serverKey;var a=parseInt(t.peerId,10);var u=parseInt(t.clientsNumber,10);var f=parseInt(t.serverPort,10);if(a<1||a>u){this.options.onError(new Error("Invalid peer id"));return false}this.peers=h(u,a);this.lastCheckedDate=new Date;var v=function e(t){if(n.peer.connections[t.id]){var r=n.peer.connections[t.id].find(function(e){return e.open});if(r){return}}t.on("open",function(){n.options.onOpenRemote(t.peer)}).on("data",function(e){if(e.jsonrpc){n.sync.receive(t.peer,e)}else{n.options.onReceive(t.peer,e)}}).on("close",function(){n.options.onCloseRemote(t.peer)}).on("error",function(e){n.options.onError(e)})};var p=function e(){n.peers.filter(function(e){return!(e in n.peer.connections)}).forEach(function(e){var t=n.peer.connect(e,{serialization:"json"});v(t)})};this.peer=new s.default(l(a),{host:r,key:i,port:f,secure:window.location.protocol==="https:"});this.peer.on("open",function(){p();n.options.onOpen()});this.peer.on("connection",function(e){v(e)});this.peer.on("disconnected",function(){n.peer.destroy();n.sync.destroy()});this.peer.on("close",function(){n.options.onClose()});this.peer.on("error",function(e){n.options.onError(e);if(e.type!=="disconnected"&&e.type!=="peer-unavailable"){n.disconnect(true)}});this.sync=(0,o.create)({delay:100,interval:this.options.syncInterval,peers:[],timeout:1e4});this.sync.send=function(e,t){n.send(e,t)};this.sync.on("sync",function(e){if(e==="start"){var t=Object.keys(n.peer.connections).filter(function(e){return n.peer.connections[e].some(function(e){return e.open})});n.sync.options.peers=t}else if(e==="end"){n.sync.options.peers=[]}});this.sync.on("change",function(e){n.offset=e});this.syncInterval=setInterval(p,c);this.syncTickInterval=setInterval(function(){var e=new Date(n.sync.now());if(e.getSeconds()!==n.lastCheckedDate.getSeconds()){n.options.onSyncTick(n.offset);n.lastCheckedDate=e}},this.options.syncTickFrequency);return true}},{key:"disconnect",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!t&&(!this.peer||!this.peer.open)){throw new Error("Connection is already closed")}this.peer.disconnect();clearInterval(this.syncInterval);clearInterval(this.syncTickInterval);this.syncTickInterval=null;this.syncInterval=null}},{key:"sendToAll",value:function e(t){var n=this;this.peers.forEach(function(e){n.send(e,t)})}},{key:"send",value:function e(t,n){var r=this.peer.connections[t];var i=r&&r.filter(function(e){return e.open})[0];if(i){i.send(n)}}}]);return e}();t.default=p;e.exports=t["default"]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s="automaton";function o(){var e=window.localStorage.getItem(s);return e?JSON.parse(e):{}}function a(e){window.localStorage.setItem(s,JSON.stringify(e))}var u={clientsNumber:4,peerId:1,serverHost:"0.peerjs.com",serverKey:"gs5wl7sq2cblnmi",serverPort:9e3};var c=function(){function e(){i(this,e);this.configuration=Object.assign({},u,o())}r(e,[{key:"update",value:function e(t,n){this.configuration[t]=n;a(this.configuration)}},{key:"getConfiguration",value:function e(){return this.configuration}}]);return e}();t.default=c;e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=3;var o=["main-view","settings-view"];var a="settings-view";var u=function(){function e(){i(this,e);this.allFormElems=document.querySelectorAll("form input");this.connectButtonElem=document.getElementById("connect-button");this.connectedPeersElem=document.getElementById("connected-peers");this.disconnectButtonElem=document.getElementById("disconnect-button");this.errorMessagesElem=document.getElementById("error-messages");this.offsetMonitorElem=document.getElementById("offset-monitor");this.tickElem=document.getElementById("tick");this.errorMessages=[];this.changeView(o.indexOf(a))}r(e,[{key:"changeConnectionState",value:function e(t,n){this.connectButtonElem.disabled=t||n;this.disconnectButtonElem.disabled=t||!n;for(var r=0;r<this.allFormElems.length;r++){this.allFormElems[r].disabled=t||n}}},{key:"updateSettings",value:function e(t){Object.keys(t).forEach(function(e){var n=document.getElementById(e);if(n){n.value=t[e]}})}},{key:"updateOffset",value:function e(t){this.offsetMonitorElem.innerText=t.toFixed(1)+" ms"}},{key:"addErrorMessage",value:function e(t){var n=this;this.errorMessages.push({timestamp:new Date,message:t});if(this.errorMessages.length>s){this.errorMessages.shift()}this.errorMessagesElem.innerHTML="";this.errorMessages.forEach(function(e){var t=document.createElement("div");var r=e.timestamp.toISOString();t.innerText=r+" "+e.message;n.errorMessagesElem.appendChild(t)})}},{key:"addRemotePeer",value:function e(t){var n=document.createElement("div");n.class="connected-peer";n.innerText=t;n.id=t;this.connectedPeersElem.appendChild(n)}},{key:"removeRemotePeer",value:function e(t){var n=document.getElementById(t);this.connectedPeersElem.removeChild(n)}},{key:"changeView",value:function e(t){if(t<0||t>o.length-1){return}o.forEach(function(e){document.getElementById(e).classList.remove("view--active")});var n=o[t];document.getElementById(n).classList.add("view--active")}},{key:"tick",value:function e(){var t=this;this.tickElem.classList.add("tick--active");setTimeout(function(){t.tickElem.classList.remove("tick--active")},500)}}]);return e}();t.default=u;e.exports=t["default"]}],[34]);
//# sourceMappingURL=automaton.bundle.js.map